# ì»¤ë„¥ì…˜ ì œì–´

## bind

- `ê¸°ë³¸ ê°’` : 127.0.0.1 (ë£¨í”„ë°±)
    - `0.0.0.0` ë˜ëŠ” `*` ì„¤ì • ì‹œ ì„œë²„ê°€ ê°€ì§€ê³  ìˆëŠ” IP ì£¼ì†Œë¡œ ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  ì—°ê²° í—ˆìš©
- ì„œë²„ì˜ ì—¬ëŸ¬ IP ì¤‘ ì–´ë–¤ IPë¥¼ í†µí•´ ë“¤ì–´ì˜¤ëŠ” ì—°ê²°ì„ ë°›ì•„ë“¤ì¼ì§€ ê²°ì •
- ê¸°ë³¸ ê°’ì„ ë³€ê²½í•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ì§ ë™ì¼í•œ ì„œë²„ ë‚´ì˜ ì—°ê²°ë§Œì„ í—ˆìš©
- ì—¬ëŸ¬ ê°œì˜ IPë¡œ ì„¤ì • ê°€ëŠ¥
- ë ˆë””ìŠ¤ ì„œë²„ ì™¸ë¶€ì—ì„œ ì—°ê²°ì´ í•„ìš”í•  ê²½ìš° ë‹¤ë¥¸ IP ì£¼ì†Œë¡œ ëª…ì‹œì  ì„¤ì • í•„ìš”

## íŒ¨ìŠ¤ì›Œë“œ

- ë ˆë””ìŠ¤ ì„œë²„ì— í•˜ë‚˜ì˜ íŒ¨ìŠ¤ì›Œë“œ ì„¤ì •
- ì•„ë˜ ë°©ë²•ì€ ë²„ì „ 6 ì´í•˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹

### íŒ¨ìŠ¤ì›Œë“œ ì„¤ì • ë°©ì•ˆ

**1) `redis.conf` ì„¤ì •**

```bash
# redis.conf
requirepass {password}
```

**2) ì„œë¹„ìŠ¤ ìš´ì˜ ì¤‘ ì„¤ì •**

```bash
> CONFIG SET requirepass {password}
```

### íŒ¨ìŠ¤ì›Œë“œë¥¼ ì‚¬ìš©í•œ `redis-cli` ì ‘ì†

**1) `-a` ì˜µì…˜ ì´ìš©**

```bash
$ redis-cli -a {password}
```

- ì»¤ë§¨ë“œ ë‚´ íŒ¨ìŠ¤ì›Œë“œ ì…ë ¥ì´ ì•ˆì „í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤ëŠ” ê²½ê³ ê°€ ì¶œë ¥ë˜ëŠ”ë°,
    
    `--no-auth-warning` ì˜µì…˜ ì‚¬ìš© ì‹œ ê²½ê³ ê°€ ë…¸ì¶œë˜ì§€ ì•ŠìŒ
    

**2) `AUTH` ì˜µì…˜ ì´ìš©**

```bash
$ redis-cli
127.0.0.1:6379 > AUTH {password}
```

- `AUTH` ì»¤ë§¨ë“œë¥¼ ì´ìš©í•´ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•´ì•¼ ë‹¤ë¥¸ ì»¤ë§¨ë“œ ì‚¬ìš© ê°€ëŠ¥

## Protected mode

```bash
# redis.conf
protected-mode {yes/no}
```

- ë ˆë””ìŠ¤ë¥¼ ìš´ì˜ ìš©ë„ë¡œ ì‚¬ìš© ì‹œ ì„¤ì •í•˜ëŠ” ê²ƒì„ ê¶Œì¥
- ê¸°ëŠ¥ì„ ë³€ê²½í•˜ì§„ ì•Šì§€ë§Œ ë‹¤ë¥¸ ì„¤ì • ê°’ì„ ì œì–´í•˜ëŠ” ì—­í•  ìˆ˜í–‰
- `yes`ì¸ ê²½ìš° íŒ¨ìŠ¤ì›Œë“œ ë¯¸ì„¤ì • ì‹œ ë£¨í”„ë°± ì—°ê²°ë§Œì„ í—ˆìš©
- íŒ¨ìŠ¤ì›Œë“œ ì—†ì´ ì‚¬ìš©í•˜ê³ ì í•  ê²½ìš° `no`ë¡œ ë³€ê²½

# ì»¤ë§¨ë“œ ì œì–´

- `CONFIG SET` ì‚¬ìš© ì‹œ ë ˆë””ìŠ¤ì— ì§€ì •ëœ ì„¤ì • ê°’ ì¡°íšŒ ë° ëŒ€ë¶€ë¶„ì˜ íŒŒë¼ë¯¸í„° ì¬ì„¤ì • ê°€ëŠ¥
- ì´ë¡œ ì¸í•œ ì•…ì„± í´ë¼ì´ì–¸íŠ¸ê°€ ë ˆë””ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì œì–´í•  ìˆ˜ ìˆì–´ ìœ„í—˜í•¨

## ì»¤ë§¨ë“œ ì´ë¦„ ë³€ê²½

```bash
# redis.conf
rename-command CONFIG CONFIG_NEW # CONFIG ëª…ë ¹ì–´ë¥¼ CONFIG_NEWë¡œ ë³€ê²½
rename-command CONFIG ""         # CONFIG ëª…ë ¹ì–´ ì‚¬ìš© ë¶ˆê°€ ì²˜ë¦¬

# sentinel.conf
sentinel rename-command mymaster CONFIG my_config     # CONFIG -> my_config
sentinel rename-command mymaster SHUTDOWN my_shutdown # SHUTDOWN -> my_shutdown
```

- `redis.conf` ë¥¼ í†µí•´ì„œë§Œ ì„¤ì • ê°€ëŠ¥
- ì‹¤í–‰ ì¤‘ ì„¤ì • ë³€ê²½ ë¶ˆê°€ (`CONFIG SET`ì„ í†µí•œ ì„¤ì • ì¡°íšŒ ë° ì¬ì„¤ì • ë¶ˆê°€)
- ì„¼í‹°ë„ ì‚¬ìš© ì‹œ ì„¼í‹°ë„ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¥ì•  ê°ì§€ ì‹œ `REPLICAOF`, `CONFIG` ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•˜ë¯€
    
    `rename-command`ì—ì„œ ë³€ê²½í•œ ë‚´ìš©ì€ `sentinel.conf`ì—ì„œë„ ë³€ê²½ë˜ì–´ì•¼ í•¨
    

## ì»¤ë§¨ë“œ ì‹¤í–‰ í™˜ê²½ ì œì–´

- ë²„ì „ 7ë¶€í„° íŠ¹ì • ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” í™˜ê²½ ì œì–´ ê°€ëŠ¥
- ë ˆë””ìŠ¤ ì‹¤í–‰ ì¤‘ ë³€ê²½ ì‹œ ìœ„í—˜í•œ ì»¤ë§¨ë“œëŠ” ë³€ê²½í•  ìˆ˜ ì—†ë„ë¡ ì°¨ë‹¨ë¨
- ì´ëŸ¬í•œ ì»¤ë§¨ë“œì˜ ë³€ê²½ì„ ì•„ì˜ˆ ì°¨ë‹¨ ë˜ëŠ” í—ˆìš©í•˜ê±°ë‚˜ ë¡œì»¬ ì—°ê²°ì—ì„œë§Œ ë³€ê²½ ê°€ëŠ¥í•˜ë„ë¡ ì„ íƒ ê°€ëŠ¥

```bash
# redis.conf
enable-protected-configs no # ê¸°ë³¸ ì„¤ì •ì„ CONFIG ì»¤ë§¨ë“œë¡œ ìˆ˜ì • ë¶ˆê°€
enable-debug command no     # DEBUG ì»¤ë§¨ë“œ ì°¨ë‹¨
enable-module-command no    # MODULE ì»¤ë§¨ë“œ ì°¨ë‹¨
```

- `no` : ëª¨ë“  ì—°ê²°ì— ëŒ€í•˜ì—¬ ëª…ë ¹ì–´ ìˆ˜í–‰ ì°¨ë‹¨ âœ…
- `yes` : ëª¨ë“  ì—°ê²°ì— ëŒ€í•´ ëª…ë ¹ì–´ ìˆ˜í–‰ í—ˆìš©
- `local` : ë¡œì»¬ ì—°ê²°ì— ëŒ€í•´ì„œë§Œ ëª…ë ¹ì–´ ìˆ˜í–‰ í—ˆìš© âœ…

```
ğŸ’¡
* DEBUG ì»¤ë§¨ë“œ : ë ˆë””ìŠ¤ ë””ë²„ê¹… ì‹œ ì‚¬ìš©
* MODULE ì»¤ë§¨ë“œ : ëª¨ë“ˆ ë™ì  ë¡œë“œ ì‹œ ì‚¬ìš©
```

## ë ˆë””ìŠ¤ë¥¼ ì´ìš©í•œ í•´í‚¹ ì‚¬ë¡€

### 1) ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸

```bash
[centos@ServerB] $ telnet 203.0.113.1 6379
```

### 2) SSH Key ìƒì„±

```bash
[centos@ServerB] $ ssh-keygen -t rsa
Enter file in which to save the key : ./id_rsa
...
Your public key has been saved in ./id_rsa.pub.
```

### 3) ë ˆë””ìŠ¤ ë‚´ ë°ì´í„° ì €ì¥ì„ ìœ„í•´ ì‚¬ìš©ë  íŒŒì¼ ìƒì„±

```bash
[centos@ServerB] $ (echo -e "\n\n"; cat id_rsa.pub; echo -e "\n\n") > key.txt
```

### 4) ë ˆë””ìŠ¤ ë°ì´í„° ì „ì²´ ì‚­ì œ ë° (3) íŒŒì¼ ë‚´ ë°ì´í„° ì €ì¥

```bash
[centos@ServerB] $ redis-cli -h 203.0.113.1 echo flushall # ë°ì´í„° ì „ì²´ ì‚­ì œ
[centos@ServerB] $ cat key.txt | redis-cli -h 203.0.113.1 -x set key # keyë¼ëŠ” keyì— ë°ì´í„° ì €ì¥
```

### 5) ê³µê²© ëŒ€ìƒ ì„œë²„ì˜ ë ˆë””ìŠ¤ ë°ì´í„° ì €ì¥ ê²½ë¡œ/íŒŒì¼ëª… ë³€ê²½

```bash
[centos@ServerB] $ redis -h 203.0.113.1 -p 6379
> CONFIG SET dir /home/centos/.ssh # ë°ì´í„° ì €ì¥ ëŒ€ìƒ ê²½ë¡œ ë³€ê²½
OK

> CONFIG GET dir 
1) "dir"
2) "/home/centos/.ssh"

> CONFIG SET dbfilename authorized_keys # ë°ì´í„° ì €ì¥ ëŒ€ìƒ íŒŒì¼ëª… ë³€ê²½
OK

> SAVE
OK
```

- `/home/centos/.ssh/authorized_keys` : SSHë¥¼ í†µí•´ ì ‘ì† ê°€ëŠ¥í•œ Keyë“¤ì´ ì €ì¥ë˜ì–´ ìˆëŠ” íŒŒì¼
- ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ (4)ì—ì„œ ì €ì¥ëœ keyê°€ ìœ„ ê²½ë¡œì— ì €ì¥ë¨

### 6) ê³µê²© ëŒ€ìƒ ì„œë²„ ì ‘ì†

```bash
**[centos@ServerB] $ ssh -i id_rsa centos@203.0.113.1**
[centos@ServerA] $ 
```

- ì„œë²„ Bì—ì„œ ìƒì„±í•œ SSH í‚¤ë¥¼ ì„œë²„ Aì— ì§ì ‘ ë³µì‚¬í•˜ëŠ” ëŒ€ì‹  ë ˆë””ìŠ¤ë¥¼ ì´ìš©í•´ ê°„ì ‘ ì „ë‹¬
- ì„œë²„ Bì—ì„œ ìƒì„±í•œ SSH í‚¤ë¥¼ ì‚¬ìš©í•´ ì„œë²„ Aì— ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥

ğŸ” **ë”°ë¼ì„œ ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•´ì„œëŠ”..**

1. `protected-mode`ë¥¼ `yes`ë¡œ ì„¤ì • ë° íŒ¨ìŠ¤ì›Œë“œ ì„¤ì •
2. íŒ¨ìŠ¤ì›Œë“œ ë¯¸ì„¤ì • ì‹œ `enable-protected-configs` ë¥¼ `local` ë˜ëŠ” `no`ë¡œ ì„¤ì •

# ACL

- ë²„ì „ 6ë¶€í„° ìœ ì €ë¼ëŠ” ê°œë…ì„ ë„ì…í•´ ê° ìœ ì €ë³„ë¡œ ì‹¤í–‰ ì»¤ë§¨ë“œì™€ ì ‘ê·¼ ê°€ëŠ¥í•œ í‚¤ ì œí•œ ê°€ëŠ¥
- ë”°ë¼ì„œ ë²„ì „ 6 ì´ì „ì—ëŠ” íŒ¨ìŠ¤ì›Œë“œë§Œ ì•Œë©´ ìœ„í—˜í•œ ì»¤ë§¨ë“œ ì‹¤í–‰ì´ ê°€ëŠ¥í–ˆìŒ
- `rename-command` ë¥¼ í†µí•´ ì»¤ë§¨ë“œë¥¼ ë³€ê²½í•´ë„ ë…¸ì¶œë  ê²½ìš° ìš°íšŒê°€ ê°€ëŠ¥í•˜ì—¬ ì™„ë²½ ì œì–´ ë¶ˆê°€

## ìœ ì €ì˜ ìƒì„±ê³¼ ì‚­ì œ

### 1) ìœ ì € ìƒì„±

```bash
ACL SETUSER {ì´ë¦„} {í™œì„± ìƒíƒœ} >{ë¹„ë°€ë²ˆí˜¸} ~{ì ‘ê·¼ ê°€ëŠ¥ í‚¤} &{ì ‘ê·¼ ê°€ëŠ¥ pub/sub ì±„ë„} +{ì‹¤í–‰ ê°€ëŠ¥ ì»¤ë§¨ë“œ}

# example
ACL SETUSER garimoo on >password ~cached:* &* +@all -@dangerous
```

ğŸ‘¤ ê¸°ë³¸ ìœ ì €ì˜ ê¶Œí•œê³¼ íŠ¹ì§•ì€ ì•„ë˜ì™€ ê°™ìŒ

- `ìœ ì €ëª…` : default
- `ìœ ì € ìƒíƒœ` : on
- `ìœ ì € íŒ¨ìŠ¤ì›Œë“œ` : nopass (íŒ¨ìŠ¤ì›Œë“œ ì—†ìŒ)
- `ì ‘ê·¼ ê°€ëŠ¥ í‚¤` : ~* (ì „ì²´ í‚¤)
- `ì ‘ê·¼ ê°€ëŠ¥ ì±„ë„` : &* (ì „ì²´ ì±„ë„)
- `ì ‘ê·¼ ê°€ëŠ¥ ì»¤ë§¨ë“œ` : +@all (ì „ì²´ ì»¤ë§¨ë“œ)

### 2) ìœ ì € í™•ì¸

```bash
ACL GETUSER {username}
```

### 3) ìœ ì € ê¶Œí•œ ì¶”ê°€ ë¶€ì—¬

```bash
ACL SETUSER {username} ~{ì¶”ê°€ ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬í•  í‚¤}
```

### 4) ìœ ì € ì‚­ì œ

```bash
ACL DELUSER {username}
```

### 5) ìœ ì € ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ

```bash
ACL LIST
```

## ìœ ì € ìƒíƒœ ì œì–´

### ê¸°ë³¸ ì˜µì…˜

- `on` : í•´ë‹¹ ìœ ì €ë¡œì˜ ì ‘ê·¼ í—ˆìš©
- `off` : í•´ë‹¹ ìœ ì €ë¡œì˜ ì ‘ê·¼ ë¶ˆí—ˆ

### ì£¼ì˜ì‚¬í•­

- `on`ì´ë¼ëŠ” êµ¬ë¬¸ ì—†ì´ ìœ ì € ìƒì„± ì‹œ `off` ìƒíƒœì˜ ìœ ì €ë¡œ ìƒì„±
- í™œì„± ìƒíƒœì˜€ë˜ ìœ ì €ì˜ ìƒíƒœë¥¼ `off`ë¡œ ë³€ê²½ ì‹œ í˜„ì¬ ì´ë¯¸ ì ‘ì†í•œ ìœ ì €ì˜ ì—°ê²°ì€ ìœ ì§€

## íŒ¨ìŠ¤ì›Œë“œ

```bash
ACL SETUSER user1 resetpass
```

### ì—°ì‚°ì

- `>` : íŒ¨ìŠ¤ì›Œë“œ ì§€ì • (íŒ¨ìŠ¤ì›Œë“œ 1ê°œ ì´ìƒ ì§€ì • ê°€ëŠ¥)
    - 
    - 
- `<` : ì§€ì •í•œ íŒ¨ìŠ¤ì›Œë“œ ì‚­ì œ

### ì˜µì…˜

- `nopass` : íŒ¨ìŠ¤ì›Œë“œ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥
    - ê¸°ì¡´ ìœ ì €ì— `nopass` ë¶€ì—¬ ì‹œ í•´ë‹¹ ìœ ì €ì— ì„¤ì •ëœ íŒ¨ìŠ¤ì›Œë“œ ì‚­ì œ
- `resetpass` : ìœ ì €ì— ì €ì¥ëœ ëª¨ë“  íŒ¨ìŠ¤ì›Œë“œ ì‚­ì œ, `nopass` ìƒíƒœë„ ì—†ì–´ì§
    - `nopass`ë‚˜ ì‹ ê·œ íŒ¨ìŠ¤ì›Œë“œ ë¶€ì—¬ ì „ê¹Œì§€ í•´ë‹¹ ìœ ì € ì ‘ê·¼ ë¶ˆê°€

## íŒ¨ìŠ¤ì›Œë“œ ì €ì¥ ë°©ì‹

### ë²„ì „ 6 ì´ì „

- ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ì±„ë¡œ íŒ¨ìŠ¤ì›Œë“œ ì €ì¥
- `CONFIG GET requirepass` ì»¤ë§¨ë“œ ì‚¬ìš© ì‹œ íŒ¨ìŠ¤ì›Œë“œ í™•ì¸ ê°€ëŠ¥

### ë²„ì „ 6 ì´í›„

- ACLì„ ì´ìš©í•´ íŒ¨ìŠ¤ì›Œë“œ ì €ì¥ ì‹œ ë‚´ë¶€ì ìœ¼ë¡œ SHA256 ë°©ì‹ìœ¼ë¡œ ì•”í˜¸í™”
- `ACL GENPASS` ì»¤ë§¨ë“œë¥¼ í†µí•´ ë‚œìˆ˜ ìƒì„± ê°€ëŠ¥

## ì»¤ë§¨ë“œ ê¶Œí•œ ì œì–´

```bash
ACL SETUSER user1 +@all -@admin +bgsave +slowlog|get
```

- `+@all` ë˜ëŠ” `allcommands` : ëª¨ë“  ì»¤ë§¨ë“œ ìˆ˜í–‰ ê¶Œí•œ ë¶€ì—¬
- `-@all` ë˜ëŠ” `nocommands` : ëª¨ë“  ì»¤ë§¨ë“œ ìˆ˜í–‰ ë¶ˆê°€ (ê¸°ë³¸ ê°’)
- `+@<category>` , `-@<category>` : íŠ¹ì • ì¹´í…Œê³ ë¦¬ì˜ ê¶Œí•œ ì¶”ê°€/ì œê±°
- `+<command>`, `-<command>` : ê°œë³„ ì»¤ë§¨ë“œì˜ ê¶Œí•œ ì¶”ê°€/ì œê±°

### ì¹´í…Œê³ ë¦¬ ì¡°íšŒ

```bash
ACT CAT # ë¯¸ë¦¬ ì •ì˜ë˜ì–´ ìˆëŠ” ì¹´í…Œê³ ë¦¬ ì»¤ë§¨ë“œ ëª©ë¡ ì¡°íšŒ
```

- keyspace
- read
- write
- set
- sortedset
- list
- hash
- string
- hyperloglog
- geo
- stream
- pubsub
- admin
- fast
- slow
- blocking
- âš ï¸ dangerous
- connection
- transaction
- scripting

### `dangerous`

**êµ¬ì„± ë³€ê²½ ì»¤ë§¨ë“œ**

- replconf
- replicaof
- migrate
- failover

**ì¥ì•  ìœ ë°œ ì»¤ë§¨ë“œ**

- sort : ë©”ëª¨ë¦¬ì— ìˆëŠ” ëª¨ë“  í‚¤ì— ì ‘ê·¼
- flushdb
- flushall
- keys : ë©”ëª¨ë¦¬ì— ìˆëŠ” ëª¨ë“  í‚¤ì— ì ‘ê·¼

**ìš´ì˜ ì»¤ë§¨ë“œ**

- shutdown
- monitor
- acl|log, acl|deluser, acl|list, acl|setuser
- bgsave, bgrewriteaof
- info
- config|get, config|set, config|rewrite, config|resetstat
- debug
- cluster|addslots
- cluster|forget
- cluster|failver
- latency|graph, latency|doctor, latency|reset, latency|history
- client|list, client|kill, client|pause : ë¶ˆí•„ìš”í•œ ë…¸ì¶œ ë°©ì§€
- module|loadex, module|list, module|unload

### `admin`

- `dangerous` ì¹´í…Œê³ ë¦¬ì—ì„œ ì¥ì•  ìœ ë°œ ì»¤ë§¨ë“œë¥¼ ì œì™¸í•œ ì»¤ë§¨ë“œê°€ ë“¤ì–´ ìˆìŒ

### `fast`

- O(1)ë¡œ ìˆ˜í–‰ë˜ëŠ” ì»¤ë§¨ë“œ
- EX) get, spop, hset â€¦

### `slow`

- `fast` ì¹´í…Œê³ ë¦¬ì— ì†í•˜ì§€ ì•Šì€ ì»¤ë§¨ë“œ
- EX) scan, set, setbit, sunion â€¦

### `keyspace`

- í‚¤ì™€ ê´€ë ¨ëœ ì»¤ë§¨ë“œ
- EX) scan,  keys, rename, type, expire, exists â€¦

### `read`

- ë°ì´í„°ë¥¼ ì½ì–´ì˜¤ëŠ” ì»¤ë§¨ë“œ
- EX) get, hget, xtrange â€¦

### `write`

- ë©”ëª¨ë¦¬ì— ë°ì´í„°ë¥¼ ì“°ëŠ” ì»¤ë§¨ë“œ
- EX) set, lset, setbit, hmset â€¦

## í‚¤ ì ‘ê·¼ ì œì–´

- `~*` ë˜ëŠ” `allkeys` : ëª¨ë“  í‚¤ì— ëŒ€í•œ ì ‘ê·¼ì´ ê°€ëŠ¥
- `~<pattern>` : ì ‘ê·¼ ê°€ëŠ¥ í‚¤ ì •ì˜ ê°€ëŠ¥

### ë ˆë””ìŠ¤ 7 ë²„ì „ ì´í›„

- `%R~<pattern>` : í‚¤ì— ëŒ€í•œ ì½ê¸° ê¶Œí•œ
- `%W~<pattern>` : í‚¤ì— ëŒ€í•œ ì“°ê¸° ê¶Œí•œ
- `%RW~<pattern>` : ì½ê¸° ì“°ê¸° ê¶Œí•œ ëª¨ë‘ ë¶€ì—¬ (= `~<pattern>`)

## ì…€ë ‰í„°

```bash
# í‚¤ë“¤ì— ëŒ€í•œ ì½ê¸° ì»¤ë§¨ë“œ ëª¨ë‘ ìˆ˜í–‰ ê°€ëŠ¥
ACL SETUSER loguser ~log:* %R~mail:* %R~sms:*

# `log:`ì— ëŒ€í•œ ëª¨ë“  ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬
# `mail:`ì— ëŒ€í•´ì„œëŠ” `GET` ì»¤ë§¨ë“œë§Œ ê°€ëŠ¥í•˜ë„ë¡ í•¨
ACL SETUSER loguser ~log:* %R~mail:* %R~sms:* (+GET ~mail:*)
```

- ë²„ì „ 7ì—ì„œ ì¶”ê°€ëœ ë‚´ìš©
- ì½ê¸°/ì“°ê¸° ì»¤ë§¨ë“œ ì¤‘ì—ì„œë„ íŠ¹ì • ì»¤ë§¨ë“œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ ê°•ì œ

## PUB/SUB ì±„ë„ ì ‘ê·¼ ì œì–´

- `&*` : ì „ì²´ pub/sub ì±„ë„ì— ì ‘ê·¼ ê°€ëŠ¥
- `&<pattern>` : íŠ¹ì • pub/sub ì±„ë„ì—ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- `resetchannels` : ì–´ë–¤ ì±„ë„ì—ë„ ë°œí–‰/êµ¬ë… ë¶ˆê°€ (ìœ ì € ìƒì„± ì‹œ ê¸°ë³¸ ê°’)

## ìœ ì € ì´ˆê¸°í™”

- `reset` ì»¤ë§¨ë“œ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ê¶Œí•œ íšŒìˆ˜ ë° ê¸°ë³¸ ìƒíƒœë¡œ ë³€ê²½ ê°€ëŠ¥
    - `resetpass`, `resetkeys`, `resetchannels`, `off`, `-@all` ìƒíƒœë¡œ ë³€ê²½
- `ACL SETUSER` ì§í›„ì™€ ë™ì¼í•´ì§

## ACL ê·œì¹™ íŒŒì¼ë¡œ ê´€ë¦¬í•˜ê¸°

- íŒŒì¼ë¡œ ê´€ë¦¬ ê°€ëŠ¥, ê¸°ë³¸ì ìœ¼ë¡œëŠ” `redis.conf`ì— ì €ì¥
- ACL íŒŒì¼ ë¯¸ì‚¬ìš© ì‹œ `CONFIG REWRITE` ì»¤ë§¨ë“œë¥¼ í†µí•´ ëª¨ë“  ì„¤ì • ê°’ê³¼ ACL ë¡¤ì„ í•œ ë²ˆì— `redis.conf`ì—ì„œ ê´€ë¦¬ ê°€ëŠ¥

```bash
# redis.conf
aclfile /file.acl
```

- ë‹¤ë¥¸ íŒŒì¼ì—ì„œ ìœ ì € ì •ë³´ê°€ ê´€ë¦¬ë˜ë„ë¡ ì„¤ì • ê°€ëŠ¥
- ë³„ë„ íŒŒì¼ë¡œ ê´€ë¦¬ ì‹œ `ACL LOAD`, `ACL SAVE` ì»¤ë§¨ë“œë¥¼ ì´ìš©í•´ ë°ì´í„° ë¡œë“œ/ì €ì¥ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ
    
    ìš´ì˜ ì¸¡ë©´ì—ì„œ ë” ìœ ìš©í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
    
- ACL íŒŒì¼ì„ ë”°ë¡œ ì‚¬ìš©í•œë‹¤ê³  ì§€ì •í–ˆì„ ë•Œ `CONFIG REWRITE` ì‚¬ìš©í•˜ì—¬ ACL ì •ë³´ ì €ì¥ ë¶ˆê°€

# SSL/TLS

- ë²„ì „ 6ë¶€í„° SSL/TLS í”„ë¡œí† ì½œì„ ì´ìš©í•œ ë³´ì•ˆ ì—°ê²° ì§€ì›
- í‰ë¬¸ í˜•íƒœë¥¼ ì£¼ê³  ë°›ì§€ ì•Šê³  ë°ì´í„° ì „ì†¡ ê³¼ì •ì„ ì•”í˜¸í™”í•˜ì—¬ ë³´ì•ˆ ìœ„í—˜ ê°ì†Œ

## SSL/TLSë€?

- `SSL` : ì•”í˜¸í™”ë¥¼ ìœ„í•œ ì¸í„°ë„· ê¸°ë°˜ ë³´ì•ˆ í”„ë¡œí† ì½œ
- `TLS` : í˜„ì¬ ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìˆëŠ” ë³´ì•ˆ í”„ë¡œí† ì½œ (1.2 ì´ìƒ ì‚¬ìš© ê¶Œì¥)

## ë ˆë””ìŠ¤ì—ì„œ SSL/TLS ì‚¬ìš©í•˜ê¸°

### 1) ë¹Œë“œ ì‹œ SSL/TLS í™œì„±í™”

```bash
make BUILD_TLS=yes
```

- ê¸°ë³¸ì ìœ¼ë¡œ ë ˆë””ìŠ¤ì—ì„œ SSL/TLS ì„¤ì •ì€ ë¹„í™œì„±í™” ë˜ì–´ ìˆìŒ
- SSL/TLS í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  ë ˆë””ìŠ¤ ì²˜ìŒ ë¹Œë“œ ì‹œ ìœ„ì™€ ê°™ì´ ì •ì˜ í•„ìš”
- í”„ë¡œí† ì½œ ì‚¬ìš© ì‹œ ì¸ìŠ¤í„´ìŠ¤ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ ë™ì¼í•œ ì¸ì¦ì„œ ì‚¬ìš© í•„ìš”

### 2) `redis.conf` ì„¤ì •

```bash
tls-port <port>
tls-cert-file /path/to/redis.crt
tls-key-file /path/to/redis.key
tls-ca-cert-file /path/to/ca.crt
```

- `port`, `tls-port` ëª¨ë‘ ì„¤ì • ì‹œ ë ˆë””ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ëŠ” ë‘ ê°€ì§€ í¬íŠ¸ ëª¨ë‘ í†µì‹  ê°€ëŠ¥
    - `port` : ì¼ë°˜ í†µì‹  (`0` ìœ¼ë¡œ ì§€ì • ì‹œ ë¹„í™œì„±í™”)
    - `tls-port` : ì¸ì¦ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ TLS í†µì‹ 

### 3) `redis-cli` ì—°ê²°

```bash
./src/redis-cli --tls \
		--cert /path/to/redis.crt \
		--key /path/to/redis.key \
		--cacert /path/to/ca.crt
```

- `redis.conf`ì—ì„œ ì§€ì •í•œ ì¸ì¦ì„œë¡œ ì—°ê²° í•„ìš” â‡’ ì• í”Œë¦¬ì¼€ì´ì…˜ë„ ë™ì¼í•¨

## SSL/TLSë¥¼ ì‚¬ìš©í•œ HA êµ¬ì„±

### ë³µì œ êµ¬ì„±

```bash
# redis.conf
tls-port <port>

**tls-repliacation yes** # ë³µì œë³¸ì—ì„œ ë§ˆìŠ¤í„°ë¡œì˜ ì»¤ë„¥ì…˜ì„ TLSë¡œ ì—°ê²°ë˜ë„ë¡ í•¨

tls-cert-file /path/to/redis.crt
tls-key-file /path/to/redis.key
tls-ca-cert-file /path/to/ca.crt
```

- ë§ˆìŠ¤í„°ì™€ TLS ì—°ê²°ì„ ì´ìš©í•œ ë³µì œë¥¼ ìœ„í•´ì„œëŠ” ë³µì œë³¸ë„ ë§ˆìŠ¤í„°ì™€ ë™ì¼í•˜ê²Œ ìœ„ ì„¤ì • ì¶”ê°€ í•„ìš”
- `no`ë¡œ ì„¤ì • ì‹œ SSL/TLS ì—°ê²°ì´ ì•„ë‹Œ ì¼ë°˜ í”„ë¡œí† ì½œë¡œ ì—°ê²°ë˜ë©°, ì •ìƒì ìœ¼ë¡œ ë³µì œ ì—°ê²° ë¶ˆê°€

### ì„¼í‹°ë„ êµ¬ì„±

```bash
# sentinel.conf
tls-port <port>

**tls-replication yes** # ì„¼í‹°ë„ì—ì„œë„ SSL/TLS ì—°ê²°ì„ ì‚¬ìš©í•˜ë„ë¡ í•¨

tls-cert-file /path/to/redis.crt
tls-key-file /path/to/redis.key
tls-ca-cert-file /path/to/ca.crt
```

- SSL/TLS ì—°ê²°ì„ ìœ„í•´ `sentinel.conf` ë‚´ ìœ„ ë‚´ìš© ì¶”ê°€ í•„ìš”

### í´ëŸ¬ìŠ¤í„° êµ¬ì„±

```bash
# sentinel.conf
tls-port <port>

**tls-replication yes

tls-cluster yes**

tls-cert-file /path/to/redis.crt
tls-key-file /path/to/redis.key
tls-ca-cert-file /path/to/ca.crt
```

- ìœ„ì™€ ê°™ì´ ì„¤ì • ì‹œ ëª¨ë“  í´ëŸ¬ìŠ¤í„° ë…¸ë“œ ê°„ ì—°ê²°ê³¼ í´ëŸ¬ìŠ¤í„° ë²„ìŠ¤ì˜ í†µì‹ ì€ SSL/TLSë¡œ ì§„í–‰
